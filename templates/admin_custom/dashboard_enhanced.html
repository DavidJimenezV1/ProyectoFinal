{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Dashboard Admin Mejorado{% endblock %}

{% block extrastyle %}
    <link rel="stylesheet" href="{% static 'css/admin_custom.css' %}">
    <link rel="stylesheet" href="{% static 'css/animations.css' %}">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .dashboard-card {
            padding: 25px;
            border-radius: 12px;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .dashboard-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .dashboard-card.orange { background: linear-gradient(135deg, #FF6B35 0%, #FF8F43 100%); }
        .dashboard-card.blue { background: linear-gradient(135deg, #004E89 0%, #1B6BA8 100%); }
        .dashboard-card.green { background: linear-gradient(135deg, #00B4A6 0%, #00D4C4 100%); }
        .dashboard-card.red { background: linear-gradient(135deg, #E63946 0%, #FF6B6B 100%); }
        .dashboard-card.purple { background: linear-gradient(135deg, #8338EC 0%, #B76BFF 100%); }
        .dashboard-card.yellow { background: linear-gradient(135deg, #FFD60A 0%, #FFE66D 100%); color: #333; }
        
        .card-icon { font-size: 32px; margin-bottom: 10px; }
        .card-title { font-size: 14px; opacity: 0.9; margin-bottom: 10px; text-transform: uppercase; }
        .card-value { font-size: 36px; font-weight: bold; margin-bottom: 5px; }
        .card-subtitle { font-size: 12px; opacity: 0.8; }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 30px;
            padding: 20px;
        }
        
        .chart-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .chart-box h3 { margin-top: 0; color: #333; }
        
        @media (max-width: 768px) {
            .dashboard-container { grid-template-columns: 1fr; padding: 10px; }
            .charts-container { grid-template-columns: 1fr; padding: 10px; }
            .card-value { font-size: 28px; }
        }
    </style>
{% endblock %}

{% block content %}
<h1 style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin: 0; border-radius: 0;">游늵 Dashboard Administrativo</h1>

<div class="dashboard-container">
    <!-- Tarjeta 1: Ventas Totales -->
    <div class="dashboard-card orange">
        <div class="card-icon">游늵</div>
        <div class="card-title">Ventas Totales</div>
        <div class="card-value">{{ total_sales|default:"0" }}</div>
        <div class="card-subtitle">Este mes</div>
    </div>

    <!-- Tarjeta 2: 칍rdenes Pendientes -->
    <div class="dashboard-card blue">
        <div class="card-icon">游닍</div>
        <div class="card-title">칍rdenes Pendientes</div>
        <div class="card-value">{{ pending_orders|default:"0" }}</div>
        <div class="card-subtitle">Por procesar</div>
    </div>

    <!-- Tarjeta 3: Stock Total -->
    <div class="dashboard-card green">
        <div class="card-icon">游늳</div>
        <div class="card-title">Stock Total</div>
        <div class="card-value">{{ total_inventory|default:"0" }}</div>
        <div class="card-subtitle">Productos disponibles</div>
    </div>

    <!-- Tarjeta 4: Clientes Activos -->
    <div class="dashboard-card red">
        <div class="card-icon">游논</div>
        <div class="card-title">Clientes</div>
        <div class="card-value">{{ active_customers|default:"0" }}</div>
        <div class="card-subtitle">Clientes activos</div>
    </div>

    <!-- Tarjeta 5: Ingresos -->
    <div class="dashboard-card purple">
        <div class="card-icon">游눯</div>
        <div class="card-title">Ingresos</div>
        <div class="card-value">${{ total_revenue|default:"0" }}</div>
        <div class="card-subtitle">Ingresos totales</div>
    </div>

    <!-- Tarjeta 6: Tasa de Conversi칩n -->
    <div class="dashboard-card yellow">
        <div class="card-icon">游늳</div>
        <div class="card-title">Conversi칩n</div>
        <div class="card-value">{{ conversion_rate|default:"0" }}%</div>
        <div class="card-subtitle">Tasa de conversi칩n</div>
    </div>
</div>

<!-- Secci칩n de Gr치ficos -->
<div class="charts-container">
    <div class="chart-box">
        <h3>游늵 Ventas Mensuales</h3>
        <canvas id="salesChart" height="300"></canvas>
    </div>
    
    <div class="chart-box">
        <h3>游닍 Inventario por Producto</h3>
        <canvas id="inventoryChart" height="300"></canvas>
    </div>
    
    <div class="chart-box">
        <h3>游꼴 Estado de 칍rdenes</h3>
        <canvas id="ordersChart" height="300"></canvas>
    </div>
    
    <div class="chart-box">
        <h3>游눷 Ingresos Semanales</h3>
        <canvas id="revenueChart" height="300"></canvas>
    </div>
</div>

{% endblock %}

{% block extrahead %}
<script src="{% static 'js/admin_custom.js' %}"></script>
<script src="{% static 'js/charts.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Gr치fico de Ventas
        const salesCtx = document.getElementById('salesChart').getContext('2d');
        new Chart(salesCtx, {
            type: 'line',
            data: {
                labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio'],
                datasets: [{
                    label: 'Ventas ($)',
                    data: [1000, 1500, 1200, 1800, 2100, 2500],
                    borderColor: '#FF6B35',
                    backgroundColor: 'rgba(255, 107, 53, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
        
        // Gr치fico de Inventario
        const inventoryCtx = document.getElementById('inventoryChart').getContext('2d');
        new Chart(inventoryCtx, {
            type: 'bar',
            data: {
                labels: ['Producto A', 'Producto B', 'Producto C', 'Producto D', 'Producto E'],
                datasets: [{
                    label: 'Stock',
                    data: [150, 200, 100, 180, 220],
                    backgroundColor: ['#004E89', '#00B4A6', '#E63946', '#8338EC', '#FFD60A']
                }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
        
        // Gr치fico de 칍rdenes
        const ordersCtx = document.getElementById('ordersChart').getContext('2d');
        new Chart(ordersCtx, {
            type: 'doughnut',
            data: {
                labels: ['Pendientes', 'En Proceso', 'Completadas', 'Canceladas'],
                datasets: [{
                    data: [45, 120, 230, 15],
                    backgroundColor: ['#FFD60A', '#FF6B35', '#00B4A6', '#E63946']
                }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
        
        // Gr치fico de Ingresos
        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
                datasets: [{
                    label: 'Ingresos ($)',
                    data: [5000, 7200, 6800, 9100],
                    borderColor: '#8338EC',
                    backgroundColor: 'rgba(131, 56, 236, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
    });
</script>
{% endblock %}